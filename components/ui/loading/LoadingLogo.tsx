"use client";

import React, { useMemo } from "react";
import { motion } from "framer-motion";
import { cn } from "@/lib/utils";
import { BRAND_COLORS, LOADING_MESSAGES } from "./constants";

interface LoadingLogoProps {
  className?: string;
  text?: string;
  showText?: boolean;
}

export const LoadingLogo = ({ 
  className, 
  text = LOADING_MESSAGES.default, 
  showText = true 
}: LoadingLogoProps) => {
  // Check for reduced motion preference
  const prefersReducedMotion = useMemo(() => {
    if (typeof window === 'undefined') return false;
    return window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  }, []);

  // Animation variants
  const containerVariants = {
    hidden: { opacity: 0 },
    visible: { 
      opacity: 1,
      transition: { 
        duration: prefersReducedMotion ? 0.3 : 1.5,
      }
    }
  };

  const tentVariants = prefersReducedMotion ? undefined : {
    animate: {
      rotate: [-2, 2, -2],
      transition: {
        duration: 2,
        repeat: Infinity,
      }
    }
  };

  return (
    <div className={cn("flex flex-col items-center justify-center gap-4", className)}>
      <motion.div
        initial="hidden"
        animate="visible"
        variants={containerVariants}
        className="relative w-48 h-48 md:w-64 md:h-64"
      >
        <svg width="100%" height="100%" viewBox="0 0 400 226" fill="none" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <clipPath id="clip0_loading">
              <rect width="400" height="226" fill="white"/>
            </clipPath>
            <linearGradient id="paint0_linear_loading" x1="36.7328" y1="195.4" x2="400.455" y2="195.4" gradientUnits="userSpaceOnUse">
              <stop stopColor="#008A72"/>
              <stop offset="1" stopColor="#F2FBF9" stopOpacity="0"/>
            </linearGradient>
            {/* Simplified gradients for other elements - mapping to palette */}
            <linearGradient id="paint1_linear_loading" x1="132.784" y1="165.096" x2="153.864" y2="45.5147" gradientUnits="userSpaceOnUse">
              <stop stopColor="#F2FBF9"/>
              <stop offset="1" stopColor="#B3E6DD"/>
            </linearGradient>
            <linearGradient id="paint4_linear_loading" x1="315.857" y1="183.335" x2="182.586" y2="-12.9513" gradientUnits="userSpaceOnUse">
              <stop stopColor="#B3E6DD" stopOpacity="0"/>
              <stop offset="0.64" stopColor="#00AC8E" stopOpacity="0.75"/>
              <stop offset="1" stopColor="#008A72"/>
            </linearGradient>
             <linearGradient id="paint5_linear_loading" x1="239.481" y1="110.778" x2="201.789" y2="182.187" gradientUnits="userSpaceOnUse">
              <stop stopColor="#A1A1A1"/>
              <stop offset="1" stopColor="#76797B"/>
            </linearGradient>
          </defs>
          
          <g clipPath="url(#clip0_loading)">
            {/* Background / Sky / Ground */}
            <path d="M240.38 167.593C243.475 167.617 246.565 167.346 249.608 166.785C252.075 166.326 254.545 165.67 257.109 165.796C259.05 165.891 260.841 166.431 262.748 166.72C267.21 167.4 271.885 166.683 276.282 165.85C276.82 165.718 277.376 165.677 277.927 165.728C278.357 165.817 278.773 165.965 279.162 166.169C282.178 167.512 286.097 167.638 289.785 167.716L307.21 168.093C311.783 168.192 316.529 168.273 320.729 167.121C323.637 166.326 326.528 164.929 329.618 165.374C330.928 165.561 332.058 166.054 333.303 166.394C336.641 167.243 340.428 166.672 344 166.822C349.89 167.067 356.071 169.235 361.333 167.542C361.333 167.542 379.26 165.299 389.595 167.417H392.387C398.558 167.417 402.341 174.394 397.815 176.229C386.938 180.647 388.516 181.238 374.718 181.84L346.395 188.678C345.696 188.819 345.004 188.999 344.322 189.215C343.83 189.357 343.766 190.36 344.227 190.645C345.584 191.485 352.031 193.402 352.346 193.837C354.653 197.137 338.222 196.77 336.964 196.518C327.725 194.649 321.405 200.202 314.531 204.243C306.809 208.78 301.696 210.479 293.445 211.913C288.797 212.725 284.014 211.832 279.471 213.497C275.328 215.016 271.668 218.554 267.78 221.12C256.584 228.471 235.24 225.647 223.04 224.399C187.342 220.76 160.339 217.052 124.933 209.385C112.719 206.737 100.322 203.842 88.0475 205.949C77.4792 207.76 69.9508 207.93 59.4741 205.205C46.6972 201.881 28.5768 186.853 15.7082 189.069C12.6887 189.589 10.9143 187.315 8.17981 185.33C5.44529 183.345 18.6361 182.227 13.4792 181.191C9.91009 181.191 2.90755 178.625 0.790499 174.367C-1.32655 170.108 1.0687 168.589 5.80831 166.921L13.6421 166.135C14.9618 166.112 16.3121 166.227 17.5776 165.972C18.6192 165.762 19.637 165.293 20.7023 165.446C21.3548 165.586 21.9833 165.821 22.5683 166.142C24.4546 166.968 26.8193 167.094 29.0416 166.931C31.2638 166.768 33.4148 166.36 35.6234 166.186C37.6477 166.065 39.6769 166.046 41.7031 166.129L49.1366 166.312C50.8329 166.353 52.6209 166.384 54.1578 165.87C54.704 165.69 55.257 165.435 55.8541 165.483C56.0991 165.515 56.34 165.572 56.5734 165.653L60.0509 166.761C60.0509 166.761 61.3639 166.353 62.246 165.962C63.3757 165.463 64.8109 167.4 66.151 167.451C67.4911 167.502 69.0789 166.751 68.7159 165.85C71.4945 166.479 74.5276 167.107 77.2723 166.411C77.7848 166.251 78.3088 166.13 78.8397 166.051C79.5433 166.028 80.2473 166.08 80.9398 166.207C83.0388 166.46 85.1665 166.117 87.0806 165.218C87.462 164.982 87.8953 164.843 88.3427 164.813C89.1535 164.83 89.5607 165.493 90.1544 165.864C91.1111 166.482 92.587 166.404 93.8864 166.346C97.4928 166.18 100.831 166.625 104.346 167.077C107.369 167.468 110.453 166.893 113.506 166.737C121.232 166.37 128.974 166.815 136.675 167.23C141.506 167.491 149.462 167.627 154.215 166.968C158.372 166.39 177.439 166.754 184.356 166.557C186.392 166.499 189.866 167.053 191.841 167.369C193.815 167.685 197.859 167.675 198.188 166.285C202.799 167.95 223.562 166.839 228.723 167.189L240.38 167.593Z" fill="url(#paint0_linear_loading)"/>
            
            {/* Main Mountain - Green-700 */}
            <path d="M155.783 2.84114H248.502L218.422 158.18L102.718 158.006L155.783 2.84114Z" fill="#008A72"/>
            <path style={{mixBlendMode:"multiply"}} opacity="0.2" d="M155.783 2.84114H248.502L218.422 158.18L102.718 158.006L155.783 2.84114Z" fill="black"/>
            
            {/* Secondary Mountain / Details - Green-800 */}
            <path d="M197.52 158.271L197.262 158.084L232.668 2.74938L232.93 2.9363L197.52 158.271ZM153.279 158.006H152.984L191.844 2.74938L192.105 2.9363L153.279 158.006ZM129.842 158.006H129.418L175.461 2.84114H175.756L129.842 158.006Z" fill="#00AC8E"/>
            
            {/* Snow Caps - Green-200 */}
            <path d="M98.8906 155.417L152.105 0.217506L155.79 2.98048L102.575 158.18L98.8906 155.417Z" fill="#F2FBF9"/>
            <path d="M152.105 0.231098L261.296 0L264.546 3.06205L155.79 2.99068L152.105 0.231098Z" fill="#B3E6DD"/>

            {/* Forest / Trees */}
            <path d="M281.177 121.347H120.601V169.333H281.177V121.347Z" fill="#008A72"/>
            <path d="M163.444 121.347H162.979V169.333H163.444V121.347ZM135.389 121.347H134.924V169.333H135.389V121.347ZM220.516 121.347H220.051V169.333H220.516V121.347ZM192.465 121.347H192V169.333H192.465V121.347Z" fill="#00AC8E"/>
            <path d="M120.601 121.347L116.485 131.828V169.333H120.601V121.347Z" fill="#F2FBF9"/>
            <path d="M328.74 121.347H214.039V169.333H328.74V121.347Z" fill="#008A72"/>
            <path d="M209.924 121.347L214.039 131.828V169.333H209.924V121.347ZM223.712 169.333H104.702V174.071H223.712V169.333Z" fill="#F2FBF9"/>
            <path d="M342.721 169.333H223.712V174.071H342.721V169.333Z" fill="#00AC8E"/>

            {/* Animated Tent Group */}
            <motion.g 
              variants={tentVariants} 
              animate="animate" 
              style={{ transformOrigin: "300px 160px" }} // Approximate pivot
            >
               <path d="M300.17 153.214L298.059 153.14L296.902 151.281C296.872 151.231 296.825 151.192 296.77 151.172C296.737 151.158 296.702 151.152 296.667 151.153C296.631 151.154 296.596 151.163 296.565 151.178C296.533 151.194 296.504 151.216 296.481 151.243C296.458 151.27 296.441 151.301 296.431 151.335L295.732 153.408L293.696 153.965C293.639 153.98 293.589 154.013 293.554 154.061C293.512 154.12 293.494 154.193 293.503 154.265C293.512 154.337 293.548 154.403 293.605 154.448L295.281 155.807L295.176 158.006C295.173 158.058 295.185 158.108 295.208 158.154C295.232 158.199 295.268 158.237 295.311 158.265C295.355 158.289 295.404 158.301 295.454 158.299C295.503 158.296 295.55 158.28 295.589 158.251L297.327 157.017L299.301 157.823C299.356 157.841 299.416 157.841 299.471 157.823C299.539 157.801 299.596 157.753 299.629 157.689C299.662 157.626 299.668 157.551 299.647 157.483L299.043 155.362L300.37 153.663C300.404 153.614 300.424 153.556 300.427 153.496C300.43 153.425 300.405 153.355 300.356 153.302C300.308 153.25 300.241 153.218 300.17 153.214Z" fill="#F44444"/>
               
               {/* Tent Details / Accents */}
               <path d="M289.683 141.49C289.683 141.418 289.697 141.346 289.724 141.28C289.751 141.214 289.792 141.153 289.842 141.102C289.893 141.052 289.953 141.011 290.02 140.984C290.086 140.956 290.157 140.942 290.229 140.942H306.616C306.761 140.942 306.9 141 307.002 141.103C307.104 141.205 307.162 141.344 307.162 141.49L309.32 148.219C309.319 148.363 309.261 148.502 309.159 148.605C309.056 148.707 308.918 148.765 308.773 148.766H292.383C292.239 148.765 292.1 148.707 291.998 148.605C291.896 148.502 291.838 148.363 291.837 148.219L289.683 141.49Z" fill="#F2FBF9"/>
               <path d="M308.774 148.956H292.383C292.287 148.956 292.191 148.937 292.101 148.9C292.012 148.863 291.931 148.809 291.863 148.74C291.794 148.672 291.74 148.59 291.703 148.501C291.666 148.411 291.647 148.315 291.647 148.219L289.489 141.49C289.49 141.293 289.568 141.106 289.707 140.967C289.846 140.828 290.033 140.75 290.229 140.749H306.616C306.812 140.75 306.999 140.828 307.138 140.967C307.276 141.106 307.354 141.293 307.355 141.49L309.51 148.219C309.51 148.414 309.432 148.602 309.294 148.74C309.156 148.878 308.969 148.956 308.774 148.956ZM290.229 141.14C290.183 141.139 290.137 141.149 290.095 141.167C290.053 141.185 290.015 141.211 289.983 141.245C289.951 141.278 289.927 141.318 289.911 141.361C289.895 141.404 289.888 141.45 289.89 141.496L292.044 148.225C292.044 148.316 292.08 148.402 292.143 148.466C292.207 148.529 292.293 148.565 292.383 148.565H308.774C308.818 148.565 308.862 148.557 308.904 148.54C308.945 148.523 308.982 148.498 309.014 148.466C309.045 148.434 309.07 148.397 309.087 148.356C309.104 148.314 309.113 148.27 309.113 148.225L306.958 141.496C306.961 141.45 306.954 141.404 306.938 141.361C306.922 141.318 306.897 141.278 306.865 141.245C306.834 141.211 306.795 141.185 306.753 141.167C306.711 141.149 306.665 141.139 306.619 141.14H290.229Z" fill="#00AC8E"/>
               <path d="M309.32 141.49C309.32 141.418 309.334 141.346 309.361 141.28C309.388 141.214 309.429 141.153 309.479 141.102C309.53 141.052 309.59 141.011 309.657 140.984C309.723 140.956 309.794 140.942 309.866 140.942H326.253C326.398 140.942 326.537 141 326.639 141.103C326.741 141.205 326.799 141.344 326.799 141.49L328.953 148.219C328.952 148.363 328.895 148.502 328.792 148.605C328.69 148.707 328.552 148.765 328.407 148.766H312.02C311.876 148.765 311.737 148.707 311.635 148.605C311.533 148.502 311.475 148.363 311.474 148.219L309.32 141.49Z" fill="#F2FBF9"/>
               <path d="M328.414 148.956H312.027C311.832 148.956 311.644 148.879 311.505 148.74C311.367 148.602 311.288 148.415 311.288 148.219L309.133 141.49C309.134 141.293 309.212 141.106 309.351 140.967C309.489 140.828 309.677 140.75 309.873 140.749H326.26C326.455 140.75 326.643 140.828 326.782 140.967C326.92 141.106 326.998 141.293 326.999 141.49L329.154 148.219C329.153 148.415 329.074 148.602 328.936 148.74C328.797 148.879 328.61 148.956 328.414 148.956ZM309.873 141.14C309.801 141.136 309.731 141.155 309.671 141.194C309.611 141.233 309.564 141.29 309.539 141.357C309.522 141.401 309.514 141.449 309.517 141.496L311.674 148.225C311.674 148.316 311.71 148.402 311.774 148.466C311.837 148.529 311.924 148.565 312.014 148.565H328.414C328.459 148.565 328.503 148.557 328.544 148.54C328.585 148.523 328.623 148.498 328.654 148.466C328.686 148.434 328.711 148.397 328.728 148.356C328.745 148.314 328.753 148.27 328.753 148.225L326.595 141.496C326.598 141.45 326.591 141.404 326.575 141.361C326.559 141.318 326.534 141.278 326.502 141.245C326.471 141.211 326.433 141.185 326.39 141.167C326.348 141.149 326.302 141.139 326.256 141.14H309.873Z" fill="#00AC8E"/>
               <path d="M328.953 141.49C328.954 141.345 329.012 141.206 329.114 141.104C329.217 141.001 329.355 140.943 329.5 140.942H345.89C345.962 140.942 346.033 140.956 346.099 140.984C346.165 141.011 346.226 141.051 346.276 141.102C346.327 141.153 346.367 141.213 346.395 141.28C346.422 141.346 346.436 141.418 346.436 141.49L348.59 148.219C348.59 148.363 348.533 148.502 348.431 148.605C348.326 148.707 348.19 148.765 348.044 148.766H331.657C331.513 148.765 331.374 148.707 331.272 148.605C331.17 148.502 331.112 148.363 331.111 148.219L328.953 141.49Z" fill="#F2FBF9"/>
               <path d="M348.044 148.956H331.657C331.462 148.956 331.274 148.879 331.136 148.74C330.997 148.602 330.919 148.415 330.918 148.219L328.753 141.49C328.753 141.294 328.83 141.106 328.968 140.967C329.106 140.828 329.294 140.749 329.489 140.749H345.88C346.076 140.75 346.263 140.828 346.402 140.967C346.538 141.106 346.616 141.293 346.616 141.49L348.774 148.219C348.773 148.413 348.696 148.599 348.56 148.737C348.423 148.875 348.238 148.954 348.044 148.956ZM329.5 141.14C329.454 141.139 329.408 141.149 329.366 141.167C329.323 141.185 329.285 141.211 329.254 141.245C329.222 141.278 329.197 141.318 329.181 141.361C329.165 141.404 329.158 141.45 329.16 141.496L331.315 148.225C331.315 148.316 331.35 148.402 331.414 148.466C331.478 148.529 331.564 148.565 331.654 148.565H348.041C348.085 148.565 348.13 148.557 348.171 148.54C348.212 148.522 348.25 148.497 348.282 148.466C348.343 148.402 348.38 148.315 348.38 148.225L346.226 141.496C346.229 141.45 346.222 141.404 346.205 141.361C346.189 141.318 346.165 141.279 346.134 141.245C346.068 141.179 345.979 141.141 345.886 141.14H329.5Z" fill="#00AC8E"/>
            </motion.g>
          </g>
        </svg>
      </motion.div>
      
      {showText && (
        <motion.p
          initial={{ opacity: 0, y: prefersReducedMotion ? 0 : 10 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: prefersReducedMotion ? 0 : 0.5 }}
          className="font-medium tracking-wide text-lg"
          style={{ color: BRAND_COLORS.grey800 }}
        >
          {text}
        </motion.p>
      )}
    </div>
  );
};
